# importing image object from PIL
import math
from PIL import Image, ImageDraw
  
# Data is in the format: (pid, tag, tstart, tend)
HEIGHT = 20
MARGIN = 0
NUMPROCS = 8

# Agent 14:
data = [
        [0,0,1349.022000,1373.786000], [0,0,2305.404000,2321.323000], [0,1,15141.008000,17563.057000], [0,3,17566.452000,17567.858000], [0,1,20613.805000,20614.687000], [0,3,20617.813000,20618.288000], 
        [1,0,12329.475000,12345.223000], [1,1,15142.608000,17563.057000], [1,3,17567.259000,17567.858000], [1,0,17570.547000,17572.893000], [1,0,17634.025000,17639.082000], [1,0,17634.025000,17639.790000], [1,0,17634.025000,17640.162000], [1,0,17634.025000,17640.555000], [1,1,20614.246000,20614.687000], [1,3,20617.835000,20618.288000], 
        [2,0,1350.500000,1371.427000], [2,0,5631.007000,5653.147000], [2,0,12533.049000,12549.757000], [2,1,15141.451000,17563.057000], [2,3,17567.659000,17567.858000], [2,0,18315.567000,18318.968000], [2,0,18514.752000,18517.493000], [2,0,18720.065000,18722.383000], [2,0,19148.928000,19151.120000], [2,0,19452.771000,19455.289000], [2,0,19831.858000,19834.169000], [2,0,20005.508000,20008.857000], [2,0,20140.489000,20144.020000], [2,0,20148.884000,20151.579000], [2,0,20228.285000,20230.572000], [2,0,20295.944000,20298.106000], [2,1,20612.385000,20614.687000], [2,3,20617.888000,20618.288000], 
        [3,0,1304.921000,1372.737000], [3,1,15141.765000,17563.057000], [3,3,17567.452000,17567.858000], [3,0,18408.700000,18411.187000], [3,0,18482.367000,18484.662000], [3,0,18813.963000,18816.323000], [3,0,18980.328000,18982.530000], [3,0,19241.657000,19257.796000], [3,0,19293.295000,19309.300000], [3,0,19317.513000,19334.600000], [3,0,19633.593000,19635.927000], [3,0,19841.760000,19844.445000], [3,0,19887.945000,19890.087000], [3,0,20227.515000,20229.725000], [3,0,20284.995000,20287.040000], [3,0,20449.030000,20451.115000], [3,1,20612.692000,20614.687000], [3,3,20617.866000,20618.288000], 
        [4,0,1362.248000,1426.638000], [4,0,3106.389000,3122.911000], [4,0,9637.504000,9640.068000], [4,0,12329.474000,12346.271000], [4,1,15648.503000,17563.057000], [4,3,17566.868000,17567.858000], [4,0,18369.740000,18372.781000], [4,0,18473.303000,18477.217000], [4,0,18609.875000,18612.042000], [4,0,18636.477000,18639.099000], [4,0,19059.996000,19062.167000], [4,0,19102.796000,19105.941000], [4,0,19286.860000,19289.034000], [4,0,19388.616000,19390.765000], [4,0,19544.511000,19547.732000], [4,0,19570.878000,19587.776000], [4,0,19999.906000,20002.073000], [4,0,20334.285000,20336.755000], [4,1,20613.242000,20614.687000], [4,3,20617.872000,20618.288000], 
        [5,0,1344.633000,1372.156000], [5,0,1415.135000,1461.755000], [5,1,15142.071000,17563.057000], [5,3,17567.063000,17567.858000], [5,0,18869.161000,18871.296000], [5,0,19293.272000,19308.157000], [5,0,19866.051000,19881.158000], [5,0,20259.213000,20261.690000], [5,1,20613.309000,20614.687000], [5,3,20617.868000,20618.288000], 
        [6,0,1348.961000,1370.723000], [6,0,3621.450000,3636.868000], [6,0,5234.777000,5263.000000], [6,1,15725.187000,17563.057000], [6,3,17566.627000,17567.858000], [6,0,17570.538000,17572.557000], [6,0,19116.163000,19118.855000], [6,0,19190.098000,19192.681000], [6,0,19222.001000,19224.777000], [6,0,19260.000000,19262.165000], [6,0,19293.249000,19308.177000], [6,0,19316.816000,19333.389000], [6,0,19539.738000,19541.749000], [6,0,19770.994000,19773.652000], [6,0,19865.420000,19881.503000], [6,0,20294.913000,20297.031000], [6,1,20613.546000,20614.687000], [6,3,20617.821000,20618.288000], 
        [7,0,77.562000,79.719000], [7,0,1347.732000,1372.975000], [7,0,3593.272000,3609.055000], [7,1,17562.799000,17563.057000], [7,3,17566.155000,17567.858000], [7,0,18385.422000,18387.609000], [7,0,18485.846000,18488.876000], [7,0,19182.169000,19184.338000], [7,0,19220.994000,19223.203000], [7,0,19379.512000,19382.000000], [7,0,19398.748000,19400.902000], [7,0,19460.274000,19462.803000], [7,0,19568.615000,19570.781000], [7,0,19731.932000,19734.374000], [7,0,19864.738000,19881.824000], [7,0,20003.917000,20006.598000], [7,0,20097.862000,20100.314000], [7,0,20193.927000,20196.522000], [7,0,20463.051000,20465.185000], [7,1,20614.526000,20614.687000], [7,3,20617.877000,20618.288000], 
]
# Total, block, % = 20619.098000, 16669.713000, 80.845986 %
# Num nodes = 19458; 2230 (11.5 %), 2215 (11.4 %), 2517 (12.9 %), 2494 (12.8 %), 2469 (12.7 %), 2609 (13.4 %), 2624 (13.5 %), 2300 (11.8 %), 
TMAX = int(20619.098)

SCALE = 1000/TMAX

# Color Dict
tagColor = {
    0:"red", 
    1:"green", 
    2:"blue", 
    3:"yellow",
    4:"purple", 
    5:"orange",
}

# Get max time
if(TMAX<0):
    for datum in data:
        TMAX = int(datum[3]*SCALE) if int(datum[3]*SCALE)>TMAX else TMAX
TMAX = int(SCALE*TMAX)

# Set up frame
w,h = TMAX, HEIGHT*NUMPROCS
img = Image.new("RGB", (w,h))
img1 = ImageDraw.Draw(img)  
img1.rectangle([0,0,w,h], fill ='white')

# Set up timelines
for i in range(0,NUMPROCS):
    img1.rectangle([0,i*HEIGHT,TMAX,(i+1)*HEIGHT-MARGIN], fill ='white', outline='black')

# Add blocks
for datum in data:
    x1 = int(datum[2]*SCALE)
    y1 = HEIGHT * datum[0]
    x2 = int(datum[3]*SCALE)
    y2 = y1+HEIGHT-MARGIN
    img1.rectangle([x1,y1+1,x2,y2-1], fill =tagColor[datum[1]], outline =None)

# Save
img.save('../outputs/timeline.jpg')
