# importing image object from PIL
import math
from PIL import Image, ImageDraw
  
# Data is in the format: (pid, tag, tstart, tend)
HEIGHT = 40
MARGIN = 0
NUMPROCS = 8
# Agent 3:
data = [
        [0,0,6630.464000,6646.171000], [0,0,15552.023000,15567.659000], [0,0,39408.532000,39423.846000], [0,0,44183.360000,44198.770000], [0,0,48810.263000,48825.675000], [0,0,49524.805000,49540.314000], [0,0,57046.209000,57061.906000], [0,0,57117.379000,57133.018000], [0,0,59194.887000,59210.366000], [0,0,60796.366000,60812.357000], [0,0,65044.248000,65060.059000], [0,0,70985.459000,71001.150000], [0,0,71623.485000,71639.173000], [0,0,73291.529000,73306.560000], [0,0,87431.610000,87446.730000], [0,0,91438.676000,91454.036000], [0,0,93049.346000,93064.533000], [0,0,94155.358000,94171.360000], [0,0,117483.195000,117500.111000], [0,0,129035.929000,129051.719000], [0,0,169493.282000,172395.866000], [0,0,176400.166000,176429.007000], [0,0,184761.005000,184895.445000], [0,0,209830.830000,209847.441000], [0,0,234090.725000,234107.890000], [0,0,265044.152000,265061.255000], [0,0,271412.686000,271429.237000], [0,0,282619.137000,282635.792000], [0,0,285042.783000,285059.331000], [0,0,287151.705000,287168.775000], [0,1,315216.284000,354412.480000], [0,0,359965.323000,359982.747000], [0,0,360484.877000,360542.144000], [0,0,362008.594000,362024.783000], [0,0,367849.885000,367865.347000], [0,0,369138.224000,369235.141000], [0,0,369406.529000,369422.184000], [0,0,369406.529000,369422.184000], [0,0,378266.353000,378354.076000], [0,0,387892.656000,387908.461000], [0,0,390637.252000,390653.206000], [0,0,393584.498000,393600.726000], [0,0,402557.141000,402572.419000], 
        [1,0,15551.834000,15567.698000], [1,0,30306.449000,30322.715000], [1,0,47313.714000,47330.343000], [1,0,59222.409000,59239.078000], [1,0,65044.294000,65060.086000], [1,0,67224.768000,67240.886000], [1,0,87699.938000,87715.159000], [1,0,117332.655000,117347.695000], [1,0,144361.072000,144380.059000], [1,0,239629.083000,239646.102000], [1,0,239877.621000,239894.123000], [1,0,241035.177000,241052.958000], [1,0,241964.522000,241980.995000], [1,0,248916.873000,248933.202000], [1,0,249384.935000,249401.606000], [1,0,276732.097000,276748.582000], [1,0,288224.822000,288241.332000], [1,0,293045.710000,293062.835000], [1,0,305678.074000,305695.255000], [1,0,305979.226000,305996.212000], [1,1,315216.697000,354412.480000], [1,0,366628.665000,366644.237000], 
        [2,0,4526.833000,4543.909000], [2,0,15551.770000,15568.674000], [2,0,30305.618000,30322.767000], [2,0,32357.528000,32364.242000], [2,0,38253.536000,38270.597000], [2,0,47313.717000,47330.440000], [2,0,51387.483000,51403.537000], [2,0,57046.217000,57063.250000], [2,0,58820.234000,58836.864000], [2,0,59358.098000,59374.736000], [2,0,59383.782000,59399.934000], [2,0,87780.281000,87796.516000], [2,0,88159.550000,88176.148000], [2,0,104539.803000,104579.428000], [2,0,105220.070000,105236.227000], [2,0,112358.995000,112555.205000], [2,0,144358.443000,144375.228000], [2,0,198867.830000,198884.059000], [2,0,241964.753000,241980.919000], [2,0,242201.738000,242218.295000], [2,0,242447.562000,242463.773000], [2,0,249384.740000,249401.564000], [2,0,254500.815000,254507.376000], [2,0,254517.356000,254531.261000], [2,0,255202.195000,255219.002000], [2,0,260355.139000,260361.414000], [2,0,275044.809000,275061.253000], [2,0,283773.349000,283789.602000], [2,0,293045.689000,293062.483000], [2,0,294325.985000,294342.201000], [2,0,305678.050000,305695.213000], [2,1,315213.649000,354412.480000], [2,0,360369.192000,360385.764000], [2,0,360433.628000,360481.886000], [2,0,360485.244000,361266.292000], [2,0,361598.235000,361618.188000], [2,0,362740.052000,362759.176000], [2,0,365197.008000,365202.125000], [2,0,369138.595000,369237.468000], [2,0,374632.323000,374649.057000], [2,0,376138.997000,376155.954000], [2,0,378266.640000,378354.938000], [2,0,393972.918000,393989.331000], [2,0,402556.983000,402574.057000], [2,0,402700.996000,402717.411000], 
        [3,0,21383.380000,21400.463000], [3,0,39407.990000,39425.337000], [3,0,39459.942000,39476.109000], [3,0,51387.458000,51403.975000], [3,0,51454.132000,51470.997000], [3,0,59222.433000,59239.148000], [3,0,59358.152000,59374.803000], [3,0,61044.340000,61060.364000], [3,0,68294.088000,68310.612000], [3,0,73858.812000,73875.428000], [3,0,87780.278000,87796.558000], [3,0,88159.556000,88176.173000], [3,0,88535.444000,88552.347000], [3,0,94155.387000,94171.403000], [3,0,104539.983000,104578.019000], [3,0,144358.412000,144378.179000], [3,0,241737.148000,241753.638000], [3,0,241874.340000,241890.421000], [3,0,254470.343000,254486.788000], [3,0,267829.209000,267846.150000], [3,0,275044.751000,275061.376000], [3,0,287151.600000,287168.675000], [3,1,315216.010000,354412.480000], [3,0,358596.560000,358612.973000], [3,0,360387.346000,361268.261000], [3,0,362008.815000,362025.846000], [3,0,366628.095000,366645.460000], [3,0,369092.582000,369109.392000], [3,0,369138.139000,369238.673000], [3,0,369404.947000,369424.234000], [3,0,369549.749000,369566.443000], [3,0,375847.695000,375866.766000], [3,0,378245.996000,378263.412000], [3,0,378698.598000,378715.294000], [3,0,387893.042000,387909.851000], [3,0,388108.294000,388125.197000], [3,0,390564.224000,390581.429000], 
        [4,0,2884.791000,2900.409000], [4,0,6407.871000,6423.247000], [4,0,21046.069000,21061.189000], [4,0,38413.722000,38428.765000], [4,0,56876.168000,56891.326000], [4,0,59809.632000,59825.401000], [4,0,69068.228000,69084.235000], [4,0,87780.216000,87795.357000], [4,0,89482.116000,89497.687000], [4,0,90908.627000,90924.206000], [4,0,91779.966000,91795.693000], [4,0,93305.618000,93320.684000], [4,0,104538.691000,104579.941000], [4,0,105220.106000,105235.120000], [4,0,144355.272000,144374.872000], [4,0,145178.693000,145229.522000], [4,0,152294.992000,152310.984000], [4,0,156355.301000,156363.681000], [4,0,157006.378000,157179.198000], [4,0,198980.965000,198995.881000], [4,0,234830.529000,234845.889000], [4,0,267795.512000,267811.355000], [4,0,281952.224000,281967.920000], [4,0,282324.765000,282339.925000], [4,0,282478.565000,282493.771000], [4,0,282618.216000,282634.280000], [4,0,294352.007000,294367.169000], [4,0,305053.360000,305068.751000], [4,0,305677.579000,305693.747000], [4,1,317759.079000,354412.480000], [4,0,360369.397000,360384.885000], [4,0,360389.458000,360433.641000], [4,0,360434.053000,360482.316000], [4,0,360544.817000,361267.104000], [4,0,362033.604000,362049.357000], [4,0,362318.675000,362334.351000], [4,0,365035.123000,365050.335000], [4,0,365154.418000,365169.539000], [4,0,366628.602000,366644.169000], [4,0,369092.905000,369109.797000], [4,0,369135.025000,369234.667000], [4,0,375782.604000,375798.570000], [4,0,375848.252000,375867.330000], [4,0,375881.693000,375899.016000], [4,0,376137.910000,376154.860000], [4,0,378264.356000,378355.648000], [4,0,380406.016000,380421.080000], [4,0,390636.767000,390653.808000], [4,0,393416.438000,393432.139000], [4,0,397646.063000,397663.971000], [4,0,402557.231000,402572.240000], 
        [5,0,6741.754000,6757.322000], [5,0,14206.929000,14222.625000], [5,0,15552.052000,15567.641000], [5,0,32356.874000,32362.217000], [5,0,44183.413000,44198.803000], [5,0,46190.777000,46206.164000], [5,0,47121.976000,47137.662000], [5,0,51702.455000,51719.022000], [5,0,59194.944000,59210.353000], [5,0,59358.091000,59373.820000], [5,0,59809.560000,59825.376000], [5,0,69043.478000,69059.097000], [5,0,69383.693000,69399.112000], [5,0,69609.205000,69624.920000], [5,0,87723.809000,87740.155000], [5,0,91780.011000,91796.005000], [5,0,94155.375000,94170.524000], [5,0,104542.930000,104578.526000], [5,0,144363.921000,144381.125000], [5,0,156987.842000,157178.339000], [5,0,198829.769000,198844.920000], [5,0,234090.806000,234106.432000], [5,0,241737.137000,241752.608000], [5,0,256231.810000,256247.157000], [5,0,265044.168000,265059.903000], [5,0,275895.672000,275911.329000], [5,0,294325.033000,294340.717000], [5,0,305678.062000,305693.736000], [5,0,312572.530000,312587.732000], [5,0,314253.232000,314269.628000], [5,1,315218.112000,354412.480000], [5,0,360368.910000,360385.281000], [5,0,360389.780000,360435.356000], [5,0,360484.688000,361265.533000], [5,0,361599.214000,361614.569000], [5,0,362008.569000,362024.481000], [5,0,365258.698000,365263.921000], [5,0,369136.709000,369235.936000], [5,0,376139.084000,376154.389000], [5,0,378265.152000,378357.078000], [5,0,378698.598000,378714.257000], [5,0,387891.891000,387908.441000], [5,0,390637.272000,390652.659000], [5,0,393416.440000,393432.159000], [5,0,393899.116000,393914.490000], [5,0,397839.967000,397855.996000], [5,0,403369.538000,403386.470000], 
        [6,0,1368.322000,1373.503000], [6,0,2884.846000,2901.752000], [6,0,6407.771000,6424.019000], [6,0,14413.334000,14429.965000], [6,0,39408.043000,39426.620000], [6,0,47059.766000,47076.633000], [6,0,69609.289000,69626.259000], [6,0,70985.500000,71002.473000], [6,0,74010.166000,74026.812000], [6,0,74579.701000,74596.769000], [6,0,78417.150000,78434.665000], [6,0,85056.671000,85073.632000], [6,0,91780.065000,91797.031000], [6,0,93305.658000,93322.211000], [6,0,104539.809000,104578.940000], [6,0,116361.565000,117281.728000], [6,0,144360.573000,144379.017000], [6,0,145231.278000,145248.061000], [6,0,234090.758000,234106.438000], [6,0,256231.822000,256247.178000], [6,0,263543.382000,263558.714000], [6,0,276732.095000,276747.159000], [6,0,278115.812000,278130.824000], [6,0,286862.342000,286877.490000], [6,0,287151.612000,287167.179000], [6,0,293045.683000,293062.520000], [6,0,294114.197000,294130.312000], [6,1,318335.310000,354412.480000], [6,0,360387.836000,360434.130000], [6,0,360437.240000,360481.467000], [6,0,360481.810000,360541.749000], [6,0,360545.161000,361269.427000], [6,0,362008.749000,362024.522000], [6,0,362318.640000,362334.319000], [6,0,362596.571000,362612.715000], [6,0,362741.392000,362758.838000], [6,0,365523.665000,365529.016000], [6,0,366357.206000,366375.365000], [6,0,369092.905000,369109.350000], [6,0,369133.422000,369237.022000], [6,0,374533.259000,374553.250000], [6,0,376526.482000,376531.710000], [6,0,378245.847000,378356.738000], [6,0,388108.243000,388123.640000], [6,0,390637.317000,390655.593000], [6,0,393584.478000,393599.478000], [6,0,393899.213000,393914.512000], [6,0,402625.684000,402641.766000], [6,0,403369.068000,403385.421000], 
        [7,0,1363.627000,1372.688000], [7,0,3475.645000,3484.730000], [7,0,3928.175000,3944.833000], [7,0,48810.287000,48826.983000], [7,0,51454.315000,51471.318000], [7,0,56875.502000,56892.682000], [7,0,60165.610000,60183.387000], [7,0,69383.754000,69400.639000], [7,0,69609.287000,69626.279000], [7,0,70985.479000,71002.491000], [7,0,71623.493000,71640.450000], [7,0,74010.151000,74026.823000], [7,0,77464.574000,77481.503000], [7,0,91438.719000,91455.349000], [7,0,95688.750000,95705.771000], [7,0,95993.137000,96009.647000], [7,0,104539.428000,104604.725000], [7,0,144361.431000,144378.610000], [7,0,231987.433000,232003.189000], [7,0,234830.263000,234845.974000], [7,0,271412.476000,271427.761000], [7,0,282324.758000,282339.990000], [7,0,283919.912000,283935.488000], [7,0,294747.674000,294764.662000], [7,1,354332.790000,354412.480000], [7,0,358953.840000,358968.865000], [7,0,360369.454000,360385.655000], [7,0,360386.977000,360434.895000], [7,0,360435.282000,361268.669000], [7,0,362008.800000,362025.485000], [7,0,365153.630000,365169.960000], [7,0,366356.240000,366375.019000], [7,0,369117.536000,369135.208000], [7,0,369549.191000,369570.039000], [7,0,373063.789000,373068.801000], [7,0,375782.491000,375800.629000], [7,0,375882.945000,375899.940000], [7,0,378264.915000,378354.574000], [7,0,380328.465000,380345.910000], [7,0,380405.961000,380422.408000], [7,0,393416.465000,393433.019000], [7,0,402818.151000,402834.718000], 
]
# Total, block, % = 405336.822000, 284535.345000, 70.197261 %
TMAX = -1 # -1 if max time not provided
SCALE = 1/500

# Color Dict
tagColor = {
    0:"red", 
    1:"green", 
    2:"blue", 
    3:"yellow",
    4:"purple", 
    5:"orange",
}

# Get max time
if(TMAX<0):
    for datum in data:
        TMAX = int(datum[3]*SCALE) if int(datum[3]*SCALE)>TMAX else TMAX

# Set up frame
w,h = TMAX, HEIGHT*NUMPROCS
img = Image.new("RGB", (w,h))
img1 = ImageDraw.Draw(img)  
img1.rectangle([0,0,w,h], fill ='white')

# Set up timelines
for i in range(0,NUMPROCS):
    img1.rectangle([0,i*HEIGHT,TMAX,(i+1)*HEIGHT-MARGIN], fill ='white', outline='black')

# Add blocks
for datum in data:
    x1 = int(datum[2]*SCALE)
    y1 = HEIGHT * datum[0]
    x2 = int(datum[3]*SCALE)
    y2 = y1+HEIGHT-MARGIN
    img1.rectangle([x1,y1,x2,y2], fill =tagColor[datum[1]], outline =None)

# Save
img.save('../outputs/timeline.jpg')
